body { background-color: #f7def7; height: 100vh; margin: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; overflow: hidden; font-family: sans-serif; }

/* Intro Screen */
#introScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f7def7; display: flex; justify-content: center; align-items: center; z-index: 9999; transition: 0.8s; }
#introScreen.hidden { opacity: 0; visibility: hidden; }
.intro-content { text-align: center; }
.intro-photo { width: 180px; height: 180px; margin: 0 auto 20px; border-radius: 50%; overflow: hidden; border: 5px solid white; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
.intro-photo img { width: 100%; height: 100%; object-fit: cover; }
h1 { color: #ff4d6d; margin-bottom: 10px; }

/* Основные элементы */
.overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); opacity: 0; pointer-events: none; transition: 0.5s; z-index: 2000; }
.overlay.active { opacity: 1; pointer-events: auto; }

.envelope-wrapper { position: relative; width: 300px; height: 200px; z-index: 10; animation: float 3s ease-in-out infinite; }
#envelope { position: relative; width: 100%; height: 100%; background-color: #f091a0; cursor: pointer; border-radius: 0 0 6px 6px; }

.flap { position: absolute; width: 0; height: 0; border-left: 150px solid transparent; border-right: 150px solid transparent; border-top: 105px solid #f091a0; transform-origin: top; transition: 0.4s; z-index: 30; top: 0; }
.pocket { position: absolute; width: 0; height: 0; border-left: 150px solid #f4aab9; border-right: 150px solid #f4aab9; border-bottom: 100px solid #f4aab9; border-top: 100px solid transparent; z-index: 25; bottom: 0; }
.heart-seal { position: absolute; top: 40%; left: 50%; width: 40px; height: 40px; background: #ff4d6d; z-index: 35; transform: translate(-50%, 0) rotate(45deg); transition: 0.4s; border-radius: 2px; }
.heart-seal::before, .heart-seal::after { content: ''; position: absolute; width: 40px; height: 40px; background: #ff4d6d; border-radius: 50%; }
.heart-seal::before { left: -20px; } .heart-seal::after { top: -20px; }

#envelope.open .flap { transform: rotateX(180deg); z-index: 5; }
#envelope.open .heart-seal { opacity: 0; pointer-events: none; }

.letter { position: absolute; bottom: 10px; left: 10px; width: 280px; height: 180px; z-index: 20; }
.paper { position: absolute; width: 100%; height: 100%; background: white; padding: 10px; box-sizing: border-box; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.1); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.paper img { width: 100%; height: 100%; object-fit: cover; }
.paper p { display: none; color: #ff4d6d; font-weight: bold; margin-top: 10px; text-align: center; font-size: 14px; }

/* Состояние ПОЛЕТА */
.paper.fly { 
    position: fixed; top: 50%; left: 50%; 
    width: 200px; height: 200px; 
    margin-left: -100px; margin-top: -100px;
    z-index: 1000;
    clip-path: path('M100,200 C100,200 0,130 0,60 C0,26 26,0 60,0 C78,0 93,8 100,20 C107,8 122,0 140,0 C174,0 200,26 200,60 C200,130 100,200 100,200 Z');
}
.paper.fly img { width: 100px; height: 100px; border-radius: 50%; border: 2px solid #ff4d6d; }
.paper.fly p { display: block; }

/* Состояние ЗУМА */
.paper.zoom { 
    margin-left: -200px; margin-top: -200px;
    width: 400px !important; height: 400px !important; 
    z-index: 5000 !important; 
    transform: translate(0, 0) scale(1) rotate(0deg) !important;
    clip-path: path('M200,400 C200,400 0,260 0,120 C0,53 53,0 120,0 C156,0 186,16 200,40 C214,16 244,0 280,0 C347,0 400,53 400,120 C400,260 200,400 200,400 Z') !important;
}
.paper.zoom img { width: 200px; height: 200px; }

.controls { position: fixed; bottom: 30px; z-index: 1500; }
button { padding: 12px 25px; border: none; border-radius: 20px; background: #ff4d6d; color: white; cursor: pointer; font-weight: bold; transition: 0.3s; }
button:hover { transform: scale(1.1); background: #ff758f; }

@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

.bg-heart { position: absolute; bottom: -50px; background: #ff4d6d; transform: rotate(45deg); opacity: 0.1; animation: bgUp 8s linear infinite; pointer-events: none; }
.bg-heart::before, .bg-heart::after { content: ''; position: absolute; width: 100%; height: 100%; background: inherit; border-radius: 50%; }
.bg-heart::before { left: -50%; } .bg-heart::after { top: -50%; }
@keyframes bgUp { 0% { bottom: -50px; opacity: 0; } 10% { opacity: 0.2; } 100% { bottom: 100vh; opacity: 0; } }

.burst-heart { position: fixed; width: 10px; height: 10px; background: #ff4d6d; transform: rotate(45deg); pointer-events: none; z-index: 6000; animation: heartBurst 1s ease-out forwards; }
.burst-heart::before, .burst-heart::after { content: ''; width: 10px; height: 10px; background: inherit; border-radius: 50%; position: absolute; }
.burst-heart::before { left: -5px; } .burst-heart::after { top: -5px; }
@keyframes heartBurst { 0% { opacity: 1; transform: translate(-50%, -50%) rotate(45deg) scale(1); } 100% { transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) rotate(var(--tr)) scale(0); opacity: 0; } }
